# Linux操作系统

<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [Linux操作系统](#linux操作系统)
  - [实验1 Linux 常用命令使用](#实验1-linux-常用命令使用)
    - [一、实验目的](#一实验目的)
      - [1. 熟悉 Linux 的基本使用](#1-熟悉-linux-的基本使用)
      - [2. 掌握 Linux 常用命令的使用](#2-掌握-linux-常用命令的使用)
    - [二、实验内容](#二实验内容)
      - [1. 熟悉 Linux 文件系统](#1-熟悉-linux-文件系统)
      - [2. Linux 常用命令的使用](#2-linux-常用命令的使用)
    - [三、实验步骤](#三实验步骤)
      - [1. 了解虚拟终端和图形桌面环境（无需截图）](#1-了解虚拟终端和图形桌面环境无需截图)
      - [2. 系统管理相关命令的使用](#2-系统管理相关命令的使用)
        - [(1) 帮助命令](#1-帮助命令)
        - [(2) whereis](#2-whereis)
        - [(3) 用户切换](#3-用户切换)
      - [3. 文件与目录相关命令的使用](#3-文件与目录相关命令的使用)
      - [4.网络相关命令的使用](#4网络相关命令的使用)
      - [5.打包压缩命令的使用](#5打包压缩命令的使用)

<!-- /code_chunk_output -->

>在正文部分，<font color = blue>蓝色的字</font>是**对问题的回答**或者**对下方图片的说明**。

<div STYLE="page-break-after: always;"></div>

## 实验1 Linux 常用命令使用

### 一、实验目的

#### 1. 熟悉 Linux 的基本使用

#### 2. 掌握 Linux 常用命令的使用

### 二、实验内容

#### 1. 熟悉 Linux 文件系统

#### 2. Linux 常用命令的使用

### 三、实验步骤

> **说明：实验安装的 Linux 为 Ubuntu14.04，为熟悉实验环境，可提前在自己
的 PC 安装同样版本的 Linux。**

#### 1. 了解虚拟终端和图形桌面环境（无需截图）

在桌面环境下打开终端模拟器（Terminal），使用命令完成后续实验。

#### 2. 系统管理相关命令的使用

##### (1) 帮助命令

&emsp;&emsp;熟悉 man 和 help 命令的使用。例如，man whereis 或 whereis --help 命令可以获取 whereis 的用法。  
&emsp;&emsp;<font color=red>**提示**</font>：在后续实验中，若不熟悉某条命令的用法，可使用 man 或 help 获取帮助。使用 man -k 可通过关键词查找命令的用法。

<font color=blue>
下图为 man whereis 命令的截图
</font>

![help](./pic1/2020-11-30%2022-22-33屏幕截图.png)

<font color=blue>
下图为 whereis --help 命令的截图，这个命令还可以简写为 whereis -h
</font>

![man](./pic1/2020-11-30%2022-28-31屏幕截图.png)

##### (2) whereis

&emsp;&emsp;使用命令查找 ifconfig 命令所在的位置。

<font color=blue>
下图为 查找ifconfig命令所在位置 的截图。
</font>

![whereis](./pic1/2020-12-02%2017-54-22屏幕截图.png)

##### (3) 用户切换

&emsp;&emsp;使用 su 命令在普通用户和 root 之间来回切换，注意观察“$”和“#”之间的变化。截图<font color=green>记录所使用的命令和所得结果。</font>  
&emsp;&emsp;<font color=red>注意</font>：在后续实验中，如果普通用户执行某命令时，出现“权限不够”或“permission deny”错误提示，可使用 su 切换到管理员模式后再执行，或者直接使用“sudo 要执行的命令”来执行。在部分版本的 ubuntu 中，可能需要使用 sudo su才能成功切换到 root 用户。

<font color=blue>
下图为 切换为root 的截图。
可以看到：切换为root时需要验证密码；
切换为 root 后终端的用户名和每一行命令的用户名都改为了 root（显示的颜色也变为了白色）；
显示当前目录时，不再是表示当前用户根目录的“～”，而是显示绝对路径。
</font>

![su](./pic1/2020-11-30%2022-40-41屏幕截图.png)

#### 3. 文件与目录相关命令的使用

##### (1)

①使用 ls 命令查看 Linux 目录结构，看看根目录下主要都有哪些目录；  
②进入/tmp 目录，并在该目录下新建目录 2016012345（其中 2016012345 为自己的学号，本次实验所有出现 myname 或 2016012345 的地方一定要修改为自己的姓名拼音或学号，否则视为未完成实验）。

请截图记录以上步骤所使用的命令和所得结果。

<font color=blue>
下图为 根目录的目录结构 的截图。
</font>

![ls /](./pic1/2020-12-01%2010-38-18屏幕截图.png)

<font color=blue>
下图为 在./tmp/目录下新建文件夹 的截图。
</font>

![tmp](./pic1/2020-12-01%2010-42-32屏幕截图.png)

##### (2)

①进入 2016012345（这里的 2016012345 需要做对应修改，下同）目录，使用 vi或者 gedit 编辑器创建 2016012345.sh 文件，在编辑器中输入 echo 2016012345（改为自己的学号）并保存。  
②使用 cat 命令查看 2016012345.sh 的内容

请截图记录以上步骤所使用的命令和所得结果。

<font color=blue>
下图为 在2018211169目录下新建2018211169.sh文件 的截图。
</font>

![gedit](。/../pic1/2020-12-01%2010-48-22屏幕截图.png)

<font color=blue>
下图为 2018211169.sh内容 的截图。
</font>

![2018211169.sh](./pic1/2020-12-01%2010-50-28屏幕截图.png)

##### (3)

①查看 2016012345.sh 文件的权限。  
②为所有用户增加可读、可写权限。  
③再次查看 2016012345.sh 文件的权限，看看是否达到预期。

请截图记录以上步骤所使用的命令和所得结果。

<font color=blue>
下图为 2016012345.sh文件的权限 的截图。
</font>

![ls -lh](./pic1/2020-12-01%2010-52-30屏幕截图.png)

<font color=blue>
下图为 为所有用户添加可读可写权限,并再次查看2018211169.sh文件的权限 的截图。
</font>

![chmod a+rw](./pic1/2020-12-01%2011-10-42屏幕截图.png)

##### (4)

①去除除当前用户外其它用户对 2016012345.sh 的写入权限。  
②增加当前用户的执行权限  
③再次查看文件权限。  
④执行./2016012345.sh

请截图记录以上步骤所使用的命令和所得结果。

<font color=blue>
下图为 去除除当前用户外其他用户对2018211169.sh的写入权限 的截图。
</font>

![chmod go-w](./pic1/2020-12-01%2014-48-52屏幕截图.png)

<font color=blue>
下图为 增加当前用户的执行权限并查看文件权限 的截图。
</font>

![chmod u+x](./pic1/2020-12-01%2014-56-26屏幕截图.png)

<font color=blue>
下图为 执行该文件 的截图。
</font>

![run](./pic1/2020-12-01%2014-59-07屏幕截图.png)

##### (5)

①把/tmp/2016012345/2016012345.sh 复制到/tmp/目录下  
②删除/tmp/2016012345 目录（注意，需要递归删除，或先删除文件）。

请截图记录以上步骤所使用的命令和所得结果。

<font color=blue>
下图为 复制到/tmp/目录下 的截图。
</font>

![cp](./pic1/2020-12-01%2015-01-15屏幕截图.png)

<font color=blue>
下图为 删除/tmp/2018211169目录 的截图。
</font>

![rm](./pic1/2020-12-01%2015-03-07屏幕截图.png)

##### (6)

①在/tmp 目录为/tmp/2016012345.sh 创建 1 个硬链接 2016012345.sh.ln1。  
②为/tmp/2016012345.sh 创建一个软链接/home/2016012345.sh.ln2。  
③分别用 cat 命令查看这两个链接的内容。  

请截图记录以上步骤所使用的命令和所得结果。

<font color=blue>
下图为 建立硬链接 的截图。
</font>

![ln -d](./pic1/2020-12-01%2015-08-15屏幕截图.png)

<font color=blue>
下图为 建立软链接 的截图。
</font>

![ln -s](./pic1/2020-12-01%2015-21-50屏幕截图.png)

<font color=blue>
下图为 查看这两个链接的内容 的截图。
</font>

![cat](./pic1/2020-12-01%2015-24-56屏幕截图.png)

##### (7)

①用 ls -li 查看/tmp/2016012345.sh、上一步骤创建的软连接和硬链接，截图对比其区别，在实验报告中进行说明。  
②删除/tmp/2016012345.sh 文件，尝试用 cat 命令查看（6）中创建的软链接和硬链接；  
③将/tmp 目录的 2016012345.sh.ln1 改名为 2016012345.sh，再次查看/home/2016012345.sh.ln2 的内容。对比结果，解释为什么会这样，理解软连接和硬链接的区别。

请截图记录以上步骤所使用的命令和所得结果。

<font color=blue>
下图为 ls -li分别查看三个文件 的截图。

可以看到前两个分别是单独的文件，而软链接为链接文件，指向的是tmp目录下的2018211169.sh文件。
而且可以看到，源文件与硬链接有相同的inode号，硬链接占用空间更小。
</font>

![ls -li](./pic1/2020-12-01%2015-26-19屏幕截图.png)

<font color=blue>
下图为 删除/tmp/2018211169.sh后，用cat预览两个链接 的截图。
</font>

![rm cat](./pic1/2020-12-01%2015-39-07屏幕截图.png)

<font color=blue>
下图为 改名和查看内容 的截图。
</font>

![mv ](./pic1/2020-12-01%2015-57-33屏幕截图.png)<font color=blue>
这个软链接就是链接到建立时的地址的“快捷方式”，有对应目录下的文件，该软链接就成立。
</font>

##### (8)

①用 chattr 命令将/tmp/2016012345.sh 文件设置为只能向其添加内容，不能删除内容，设置完后，用 lsattr 查看该文件的属性截图。记录所用命令及所得结果。  
②尝试用 vi 或 gedit 向该文件修改内容并保存，截图记录 vi 或 gedit 保存时出现的提示。  
③尝试通过输出重定向方式向该文件中追加内容（例如，将 ls 命令的结果追加重
定向到该文件，ls /bin >> /tmp/2016012345.sh），然后用 cat 查看文件内容，截图记录所用命令及所得结果。

<font color=blue>
下图为 设定属性 的截图。
</font>

![chattr](./pic1/2020-12-01%2016-04-06屏幕截图.png)

<font color=blue>
下图为 保存时 的截图。
</font>

![gedit1](./pic1/2020-12-01%2016-05-33屏幕截图.png)

<font color=blue>
下图为 重定向 的截图。
</font>

![gedit2](./pic1/2020-12-01%2016-08-08屏幕截图.png)

根据实验结果说说 chattr 将文件设为只能添加内容有什么特殊用途？

<font color=blue>
可以用于日志文件安全，使得历史日志不会被意外修改。
</font>

#### 4.网络相关命令的使用

>准备工作:两台 PC 通过网线接入同一局域网。
(实验室 PC 已具备这一条件;若使用自己的电脑做实验,可用手机设置 wifi 热点,两台电脑同时连接这个热点即可。)
理解 ifconfig、ping 命令,完成如下练习。记录所用命令和所得结果。

(1) ifconfig 显示或配置网络地址
1 设置网卡 eth0(不一定是这个名称,请根据自己所用 PC 的实际情况选择正确的设备名称)的 IP 地址为 192.168.x.yz(为避免 ip 地址冲突,xyz 必须设置为自己的学号最后 3 位。若学号后两位为 00,请将 IP 设置为 192.168.x.100)。
2 查看配置后的地址。

请截图记录以上步骤所使用的命令和所得结果。

<font color=blue>
下图为 更改ip地址并查看配置后地址 的截图。
</font>

![ifconfig](./pic1/2020-12-01%2022-38-40屏幕截图.png)

(2) 测试网络连通性
1询问其他同学的 ip(该同学的学号倒数第三位与自己相同),然后使用 ping 命令测试网络连通性,需要确保 ping 通。截图记录所得结果。若无法 ping 通,请检查网络配置说明,若使用虚拟机,可参考如下配置(仅针对课后使用自己 PC 完成实验的情况,实验室 PC 不涉及这一问题)
2将 IP 设置为 192.168.yz.yz(yz 为自己的学号最后 2 位),同时,另一同学的 ip也按这一规则修改(即两人的 IP 不在同一子网),然后使用 ping 命令测试网络连通性,截图记录所得结果。请解释为什么会得到这样的结果。
3(选做)若上一步骤不能 ping 通,在不改变 IP 和子网掩码的前提下,如何确保ping 通?

<font color=blue>
下图为 更改ip地址并ping192.168.1.106 的截图。
</font>

![ping1](./pic1/2020-12-01%2022-48-31屏幕截图.png)

<font color=blue>
下图为 更改到不同子网后再次ping 的截图。

>注：这里68不是某个同学的学号，是为在另一台虚拟机上随意设置的一个网络号(这里截的图没法打开，是在自己电脑上开两个虚拟机之间组网的)
</font>

![ping2](./pic1/2020-12-01%2022-53-41屏幕截图.png)

<font color = blue>
在本机的实验环境下，这两个虚拟机都是通过虚拟交换机进行桥接(Bridge方式)连接到本地物理网卡的，所以说，这两个虚拟机在同一个广播域，但虚拟机ip分别为192.168.69.69（子网掩码255.255.255.0）与 192.168.68.68（子网掩码255.255.255.0），不在同一个网段。在没有路由器的情况下，两个网络之间是不能进行TCP/IP通信的，即使是两个网络连接在同一台交换机（或集线器）上，TCP/IP协议也会根据子网掩码（255.255.255.0）判定两个网络中的主机处在不同的网络里。所以说在ping这个ip时，会显示网络不可达。
  
<p>
</p>
(选做):而要实现这两个网络之间的通信，则必须通过网关。如果网络A中的主机发现数据包的目的主机不在本地网络中，就把数据包转发给它自己的网关，再由网关转发给网络B的网关，网络B的网关再转发给网络B的某个主机。
</font>

#### 5.打包压缩命令的使用

> 理解 tar 命令的使用,完成如下练习。记录所用命令和所得结果。

(1) 把 2016012345.sh 以及其它一些文件(文件个数不少于 3 个)打包成 2016012345.tar,放到/tmp 目录下, 截图记录所使用的命令和所得结果。

<font color=blue>
cd /tmp

tar -cf /tmp/2018211169.tar 1.txt 2.txt 3.txt 2018211169.sh

下图为 打包 的截图。
</font>

![tar -cf](./pic1/2020-12-01%2020-53-49屏幕截图.png)

(2) 把上一步中同一批文件压缩打包成 2016012345.tar.gz,放到/tmp 目录下, 截图记录所使用的命令和所得结果。

<font color=blue>
下图为 压缩打包 的截图。
</font>

![tar -czf](./pic1/2020-12-01%2021-11-01屏幕截图.png)

(3) 比较 2016012345.tar 和 2016012345.tar.gz 的大小。截图并解释为什么会这样。
...(请按照实验要求完成命令)

<font color=blue>
下图为 打包文件大小比较 的截图。

.tar文件的体积非常大而.tar.gz文件的体积相比较起来要小很多，且这两个文件的体积都要比原来的4个文件的总体要大，这是由于tar指令是将文件打包起来，会有额外的打包信息，所以体积会变大，而经过-z选项将打包文件压缩之后，体积有明显地减小。不过由于原来4个文件的体积太小，而打包信息占据比例更大，体现不出“压缩”的效果。
</font>

![.tar.gz](./pic1/2020-12-01%2021-13-30屏幕截图.png)

(4) 解压 2016012345.tar.gz 的内容到/tmp/2016012345-2/目录。进入/tmp/2016012345-2/目录查看,确保解压成功。请截图记录所使用的命令和所得结果。

<font color=blue>
下图为 将2018211169.tar.gz解压到./2018211169-2目录下 的截图。
</font>

![tar -xf (filename) -C (directions)](./pic1/2020-12-01%2021-30-56屏幕截图.png)
